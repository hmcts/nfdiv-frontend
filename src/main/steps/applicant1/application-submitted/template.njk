{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "components/hmcts-progress-bar/macro.njk" import hmctsProgressBar %}

{% extends "common/page.njk" %}

{% block backLink %}{% endblock %}

{% block page_content %}
  <div class="govuk-panel govuk-panel--confirmation">
    <h1 class="govuk-panel__title">{{ title }}</h1>
    <div class="govuk-body">
      {{ referenceNumber | safe }}
    </div>
    <p><strong>{{ confirmationEmail }}</strong></p>
  </div>
  {{ hmctsProgressBar({
    items: [{
      label: {
        text: title
      },
      complete: true
    }, {
      label: {
        text: partnerResponse
      },
      complete: currentState.isAfter('AwaitingApplicant2Response'),
      active: userCase.state == 'AwaitingApplicant2Response'
    }, {
      label: {
        text: conditionalOrderGranted
      },
      complete: currentState.isAfter('AwaitingLegalAdvisorReferral'),
      active: userCase.state == 'AwaitingLegalAdvisorReferral'
    }, {
      label: {
        text: applicationEnded
      },
      complete: currentState.isAtOrAfter('FinalOrderComplete'),
      active: userCase.state == 'FinalOrderComplete'
    }]
  }) }}
  {% if userCase.applicant1CannotUpload or userCase.applicant2CannotUpload or userCase.iWantToHavePapersServedAnotherWay %}
    <h2 class="govuk-heading-l">{{ subHeading1 }}</h2>
    <p class="govuk-body">{{ line1 }}</p>
    {% if userCase.applicant1CannotUpload or userCase.applicant2CannotUpload %}
      <h3 class="govuk-heading-m">{{ subHeading2 }}</h3>
      <p class="govuk-body">{{ line2 }}</p>
      <ul class="govuk-list govuk-list--bullet">
        {% for document in userCase.applicant1CannotUploadDocuments %}
          <li>{{ documents[document] }}</li>
        {% endfor %}
      </ul>

      {% set sendingDocumentsByEmail %}
        <ol class="govuk-list govuk-list--number">
          {% for property, step in documentsByEmailSteps %}
            {% if loop.last %}
              <li>{{ step | safe }}</li>
            {% else %}
              <li>{{ step }}</li>
            {% endif %}
          {% endfor %}
        </ol>
      {% endset %}
      {{ govukDetails({
        summaryText: documentsByEmail,
        html: sendingDocumentsByEmail
      }) }}

      {% set sendingDocumentsByPost %}
        <ol class="govuk-list govuk-list--number">
          {% for property, step in documentsByPostSteps %}
            <li>{{ step }}</li>
          {% endfor %}
        </ol>
        <p class="govuk-body"><strong>{{ address | safe }}</strong></p>
        <p class="govuk-body">{{ documentsByPostMoreDetails }}</p>
      {% endset %}
      {{ govukDetails({
        summaryText: documentsByPost,
        html: sendingDocumentsByPost
      }) }}
    {% endif %}
    {% if userCase.iWantToHavePapersServedAnotherWay %}
      <h3 class="govuk-heading-m">{{ subHeading3 }}</h3>
      <p class="govuk-body">{{ line3 }}</p>
      <p class="govuk-body">{{ line4 | safe }}</p>
    {% endif %}
  {% else %}
    <h2 class="govuk-heading-l">{{ subHeading4 }}</h2>
    {% if not userCase.iWantToHavePapersServedAnotherWay %}
      <p class="govuk-body">{{ line5 }}</p>
    {% endif %}
    {% if not isJointApplication %}
      {% if hasASolicitorContactForPartner %}
        <p class="govuk-body">{{ line7 }}</p>
      {% elif not isRespondentRepresented %}
        <p class="govuk-body">{{ line6 }}</p>
      {% endif %}
      {% if applicationServedAnotherWay %}
        <p class="govuk-body">{{ line8 }}</p>
        <p class="govuk-body">{{ line9 }}</p>
      {% endif %}
      {% if isRespondentOverseas %}
        <p class="govuk-body">{{ line10 }}</p>
        <p class="govuk-body">{{ line11 }}</p>
      {% endif %}
    {% endif %}
  {% endif %}
  <h3 class="govuk-heading-m">{{ subHeading5 }}</h3>
  <p class="govuk-body">{{ line12 | safe }}</p>
  <p class="govuk-body">{{ line13 | safe }}</p>
  <p class="govuk-body">{{ line14 | safe }}</p>
  <p class="govuk-body">{{ line15 | safe }}</p>
  <h3 class="govuk-heading-m">{{ subHeading6 }}</h3>
  <p class="govuk-body">{{ line16 | safe }}</p>
  <h3 class="govuk-heading-m">{{ webChat }}</h3>
  <p class="govuk-body">{{ webChatDetails }}</p>
  <h3 class="govuk-heading-m">{{ sendUsAMessage }}</h3>
  <p class="govuk-body">{{ email | safe }}</p>
  <h3 class="govuk-heading-m">{{ telephone }}</h3>
  <p class="govuk-body">{{ telephoneNumber }}</p>
  <p class="govuk-body">{{ telephoneDetails }}</p>
  <p class="govuk-body">{{ telephoneCharges | safe }}</p>
  <p class="govuk-body">{{ domesticAbuse | safe }}</p>

  <h3 class="govuk-heading-m">{{ feedback }}</h3>
  <p class="govuk-body">{{ feedbackDetails | safe }}</p>
{% endblock %}

{% block contact_us %}{% endblock %}
