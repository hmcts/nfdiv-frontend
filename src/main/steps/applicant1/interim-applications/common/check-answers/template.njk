{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% extends "common/page.njk" %}

{% block content %}
  {% block error_summary %}
    {% include "common/error/summary.njk" %}
  {% endblock %}

  <h1 class="govuk-heading-l" id="checkAnswersTitle">{{ title }}</h1>
  <p class="govuk-body">{{ line1 }}</p>

  {% set answerRows = [] %}
    {% for question, text in stepQuestions %}
      {% if (stepAnswers[question] and stepAnswers[question] != 'undefined' and stepAnswers[question] != 'null') or question === 'yourResponse' or (question === 'uploadedFiles' and cannotUploadDocs === 'Yes') %}
          {% if stepLinks[question] %}
              {% set items = [{
                  href: stepLinks[question],
                  text: 'Change',
                  visuallyHiddenText: text
              }] %}
          {% endif %}
        {% set answerText %}
          {% if question === 'uploadedFiles' %}
            {% set filenames %}
              {% for filename in uploadedDocsFilenames %}
                {{ filename }}<br>
              {% endfor %}
            {% endset %}
            {{ filenames | safe}}
            {% if cannotUploadDocs === 'Yes' %}
              {% if uploadedDocsFilenames.length %}
                <br>
              {% endif %}
              {{ havingTroubleUploading }}
            {% endif %}
          {% elif question === 'newPostalAddress' %}
            {{ stepAnswers[question] | safe}}
          {% else %}
            {{ stepAnswers[question] }}
          {% endif %}
        {% endset %}

        {% set answerRows = (answerRows.push({
          key: {
            html: text,
            classes: 'govuk-!-width-two-thirds'
          },
          value: {
              text: answerText | safe
          },
          actions: {
            items: items
          }
        }), answerRows) %}
      {% endif %}
    {% endfor %}

    {% if answerRows.length %}
      {{ govukSummaryList({
        classes: 'govuk-!-margin-bottom-9',
        rows: answerRows
      }) }}
    {% endif %}

  {% block form %}
    {% if showStatementOfTruth %}
    <h1 class="govuk-heading-m">{{ statementOfTruth.title }}</h1>
    {{ govukWarningText({
      text: statementOfTruth.warning,
      iconFallbackText: "Warning"
    }) }}
  {% endif %}
    {% include "./form.njk" %}
  {% endblock %}
{% endblock %}

